<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>PSA Source Engine</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        :root { --primary: #00ffcc; --accent: #ff007b; --bg: #0a0f1a; --glass: rgba(16, 30, 45, 0.95); }
        body { margin: 0; overflow: hidden; background: var(--bg); font-family: 'Segoe UI', sans-serif; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #game-container { position: relative; border: 2px solid #1e293b; background: #000; box-shadow: 0 0 50px rgba(0,0,0,0.5); overflow: hidden; }
        #ui-layer {
            position: absolute; top: 15px; left: 15px; background: var(--glass); padding: 15px; 
            border-radius: 10px; border: 1px solid var(--primary); z-index: 10; min-width: 250px; pointer-events: none;
        }
        #crosshair {
            position: absolute; top: 50%; left: 50%; width: 6px; height: 6px;
            border: 2px solid var(--primary); border-radius: 50%; transform: translate(-50%, -50%);
            pointer-events: none; z-index: 5; box-shadow: 0 0 10px var(--primary);
        }
        .menu {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: var(--glass); border: 2px solid var(--primary); padding: 25px;
            text-align: center; border-radius: 15px; z-index: 20; width: 450px; max-height: 90vh; overflow-y: auto;
        }
        .stat-line { display: flex; justify-content: space-between; margin-bottom: 5px; font-family: monospace; font-size: 0.9rem; }
        button {
            background: var(--primary); color: #000; border: none; padding: 12px;
            margin-top: 10px; cursor: pointer; font-weight: 800; border-radius: 5px; text-transform: uppercase; width: 100%;
        }
        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: left; }
        label { font-size: 0.75rem; color: var(--primary); text-transform: uppercase; }
        input, select {
            width: 100%; padding: 8px; margin: 4px 0 10px 0; background: #000; color: #fff; 
            border: 1px solid #334155; border-radius: 4px; box-sizing: border-box;
        }
        #progress-bar { position: absolute; bottom: 0; left: 0; height: 6px; background: var(--accent); width: 0%; transition: width 0.1s linear; }
        #calib-overlay { display: none; position: fixed; top: 20%; left: 50%; transform: translateX(-50%); background: var(--accent); padding: 20px 40px; border-radius: 5px; font-weight: bold; z-index: 100; box-shadow: 0 0 30px var(--accent); text-align: center; border: 2px solid white; }
        .lang-select { position: absolute; top: 10px; right: 10px; width: auto; }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ */
        .social-links { display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; margin: 15px 0; }
        .social-links a { transition: transform 0.2s; }
        .social-links a:hover { transform: scale(1.05); }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="crosshair"></div>
        <div id="progress-bar"></div>
        <div id="ui-layer">
            <div class="stat-line"><span id="txt-iter-label">–ò—Ç–µ—Ä–∞—Ü–∏—è</span>: <span id="iter-val">1 / 7</span></div>
            <div class="stat-line">CS2 Sens: <span id="sens-display">1.00</span></div>
            <div class="stat-line"><span id="txt-dist-label">–î–∏—Å—Ç–∞–Ω—Ü–∏—è</span>: <span id="cm-display">0.00</span> <span id="txt-cm-unit">—Å–º/360</span></div>
            <div class="stat-line"><span id="txt-score-label">–û—á–∫–∏</span>: <span id="score">0</span></div>
        </div>
    </div>

    <div id="calib-overlay"></div>

    <div id="start-menu" class="menu">
        <select id="lang-picker" class="lang-select" onchange="setLanguage(this.value)">
            <option value="en">EN</option>
            <option value="ru">RU</option>
            <option value="tr">TR</option>
            <option value="uk">UA</option>
        </select>

        <h2 id="txt-title" style="margin: 0 0 15px 0; color: var(--primary);">PSA Source Engine</h2>
        
        <label id="txt-res-label">–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é (–® x –í)</label>
        <div class="settings-grid">
            <input type="number" id="res-w" value="1280">
            <input type="number" id="res-h" value="720">
        </div>

        <div class="settings-grid">
            <div><label id="txt-dpi-label">DPI –ú—ã—à–∏</label><input type="number" id="dpi-input" value="800"></div>
            <div><label id="txt-fov-label">FOV (CS2=90)</label><input type="number" id="fov-input" value="90"></div>
        </div>
        
        <div style="border: 1px dashed var(--primary); padding: 15px; margin: 15px 0; border-radius: 8px;">
            <label id="txt-base-label">–ë–∞–∑–æ–≤–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (Source)</label>
            <input type="number" id="base-sens-input" value="1.20" step="0.001">
            <button id="calib-btn" style="background: transparent; color: var(--primary); border: 1px solid var(--primary);">–ú–µ—Ç–æ–¥ –ë: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ 360¬∞</button>
        </div>

        <div class="social-links">
            <a href="https://github.com/Adiru3" target="_blank"><img src="https://img.shields.io/badge/GitHub-Adiru3-181717?style=for-the-badge&logo=github" alt="GitHub"></a>
            <a href="https://www.youtube.com/@adiruaim" target="_blank"><img src="https://img.shields.io/badge/YouTube-@adiruaim-FF0000?style=for-the-badge&logo=youtube" alt="YouTube"></a>
            <a href="https://www.tiktok.com/@adiruhs" target="_blank"><img src="https://img.shields.io/badge/TikTok-@adiruhs-000000?style=for-the-badge&logo=tiktok" alt="TikTok"></a>
            <a href="https://donatello.to/Adiru3" target="_blank"><img src="https://img.shields.io/badge/Support-Donatello-orange?style=for-the-badge" alt="Donatello"></a>
        </div>
        
        <button id="start-btn" style="font-size: 1.1rem; background: var(--primary);">–ó–∞–ø—É—Å—Ç–∏—Ç—å PSA —Ç–µ—Å—Ç</button>
    </div>

    <script>
        const i18n = {
            ru: {
                title: "PSA Source Engine",
                res: "–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ (–® x –í)",
                dpi: "DPI –ú—ã—à–∏",
                fov: "FOV (CS2=90)",
                base: "–ë–∞–∑–æ–≤–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (Source)",
                calibBtn: "–ú–µ—Ç–æ–¥ –ë: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ 360¬∞, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –º—ã—à—å –Ω–∞ —É–≥–æ–ª –∫–æ–≤—Ä–∏–∫–∞",
                startBtn: "–ó–∞–ø—É—Å—Ç–∏—Ç—å PSA —Ç–µ—Å—Ç, –ù–∞–∂–º–∏—Ç–µ F11 –î–ª—è –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞",
                iter: "–ò—Ç–µ—Ä–∞—Ü–∏—è",
                dist: "–î–∏—Å—Ç–∞–Ω—Ü–∏—è",
                cm: "—Å–º/360",
                score: "–û—á–∫–∏",
                calibOverlay: "–ú–ï–¢–û–î –ë: –ö–ê–õ–ò–ë–†–û–í–ö–ê<br><br>–¢–Ø–ù–ò–¢–ï –ú–´–®–¨ –í –ü–†–û–¢–ò–í–û–ü–û–õ–û–ñ–ù–´–ô –£–ì–û–õ –ù–ê –ö–û–í–†–ò–ö–ï <br>–ò –ù–ê–ñ–ú–ò–¢–ï ESC",
                finalTitle: "–ò–î–ï–ê–õ–¨–ù–ê–Ø –°–ï–ù–°–ê –ù–ê–ô–î–ï–ù–ê",
                finalSens: "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è CS2:",
                finalPhys: "–§–∏–∑–∏—á–µ—Å–∫–∏:",
                correction: "üéØ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ö–û–†–†–ï–ö–¢–ò–†–û–í–ö–ê –í –ò–ì–†–ï:",
                over: "–ü–µ—Ä–µ–ª–µ—Ç (Overshooting): –ï—Å–ª–∏ –ø—Ä–∏ —Ä–µ–∑–∫–æ–º —Ñ–ª–∏–∫–µ –ø—Ä–∏—Ü–µ–ª —É–ª–µ—Ç–∞–µ—Ç –∑–∞ –≤—Ä–∞–≥–∞ ‚Äî —Å–Ω–∏–∑—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ 0.05‚Äì0.1.",
                under: "–ù–µ–¥–æ–ª–µ—Ç (Undershooting): –ï—Å–ª–∏ —Ä—É–∫–∞ ¬´–≤—è–∑–Ω–µ—Ç¬ª –∏ —Ç—ã –Ω–µ –¥–æ–≤–æ–¥–∏—à—å –¥–æ –≥–æ–ª–æ–≤—ã ‚Äî –ø–æ–¥–Ω–∏–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ 0.05‚Äì0.1.",
                restart: "–ù–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ—Å—Ç"
            },
            en: {
                title: "PSA Source Engine",
                res: "Manual Resolution (W x H)",
                dpi: "Mouse DPI",
                fov: "FOV (CS2=90)",
                base: "Base Sensitivity (Source)",
                calibBtn: "Method B: Calibrate via 360¬∞, place mouse at mat edge",
                startBtn: "Start PSA Test, Press F11 For FullScreen",
                iter: "Iteration",
                dist: "Distance",
                cm: "cm/360",
                score: "Score",
                calibOverlay: "METHOD B: CALIBRATION<br><br>DRAG MOUSE TO THE OPPOSITE EDGE OF THE MAT <br>AND PRESS ESC",
                finalTitle: "PERFECT SENS FOUND",
                finalSens: "CS2 Setting:",
                finalPhys: "Physical:",
                correction: "üéØ FINAL IN-GAME CORRECTION:",
                over: "Overshooting: If you flick past the target ‚Äî lower result by 0.05‚Äì0.1.",
                under: "Undershooting: If your aim feels sluggish/short ‚Äî raise result by 0.05‚Äì0.1.",
                restart: "Restart Test"
            },
            tr: {
                title: "PSA Source Motoru",
                res: "Manuel √á√∂z√ºn√ºrl√ºk (G x Y)",
                dpi: "Fare DPI",
                fov: "FOV (CS2=90)",
                base: "Temel Hassasiyet (Source)",
                calibBtn: "Y√∂ntem B: 360¬∞ ile ayarla, fareyi matƒ±n k√∂≈üesine koy",
                startBtn: "PSA Testini Ba≈ülat, F11 tu≈üuna basarak tam ekran moduna ge√ßin.",
                iter: "ƒ∞terasyon",
                dist: "Mesafe",
                cm: "cm/360",
                score: "Puan",
                calibOverlay: "Y√ñNTEM B: KALƒ∞BRASYON<br><br>FAREYƒ∞ MATIN Dƒ∞ƒûER K√ñ≈ûESƒ∞NE √áEKƒ∞N <br>VE ESC TU≈ûUNA BASIN",
                finalTitle: "M√úKEMMEL HASSASƒ∞YET BULUNDU",
                finalSens: "CS2 Ayarƒ±:",
                finalPhys: "Fiziksel:",
                correction: "üéØ OYUN ƒ∞√áƒ∞ SON D√úZELTME:",
                over: "Hedefi A≈üma (Overshooting): Hedefi ge√ßiyorsanƒ±z ‚Äî sonucu 0.05‚Äì0.1 azaltƒ±n.",
                under: "Hedefe Ula≈üamama (Undershooting): Hedefe yeti≈üemiyorsanƒ±z ‚Äî sonucu 0.05‚Äì0.1 artƒ±rƒ±n.",
                restart: "Yeni Test Ba≈ülat"
            },
            uk: {
                title: "PSA Source Engine",
                res: "–†–æ–∑–¥—ñ–ª—å–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å (–® x –í)",
                dpi: "DPI –ú–∏—à—ñ",
                fov: "FOV (CS2=90)",
                base: "–ë–∞–∑–æ–≤–∞ —á—É—Ç–ª–∏–≤—ñ—Å—Ç—å (Source)",
                calibBtn: "–ú–µ—Ç–æ–¥ –ë: –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ 360¬∞, –ø–æ—Å—Ç–∞–≤—Ç–µ –º–∏—à—É –Ω–∞ –∫—É—Ç –∫–∏–ª–∏–º–∫–∞",
                startBtn: "–ó–∞–ø—É—Å—Ç–∏—Ç–∏ PSA —Ç–µ—Å—Ç",
                iter: "–Ü—Ç–µ—Ä–∞—Ü—ñ—è",
                dist: "–î–∏—Å—Ç–∞–Ω—Ü—ñ—è",
                cm: "—Å–º/360",
                score: "–û—á–∫–∏",
                calibOverlay: "–ú–ï–¢–û–î –ë: –ö–ê–õ–Ü–ë–†–£–í–ê–ù–ù–Ø<br><br>–¢–Ø–ì–ù–Ü–¢–¨ –ú–ò–®–£ –í –ü–†–û–¢–ò–õ–ï–ñ–ù–ò–ô –ö–£–¢ –ö–ò–õ–ò–ú–ö–ê <br>–¢–ê –ù–ê–¢–ò–°–ù–Ü–¢–¨ ESC",
                finalTitle: "–Ü–î–ï–ê–õ–¨–ù–£ –°–ï–ù–°–£ –ó–ù–ê–ô–î–ï–ù–û",
                finalSens: "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è CS2, –ù–∞–∂–º—ñ—Ç—å F11 –î–ª—è –ü–æ–≤–Ω–æ–µ–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞:",
                finalPhys: "–§—ñ–∑–∏—á–Ω–æ:",
                correction: "üéØ –§–Ü–ù–ê–õ–¨–ù–ï –ö–û–†–ï–ì–£–í–ê–ù–ù–Ø –í –ì–†–Ü:",
                over: "–ü–µ—Ä–µ–ª—ñ—Ç (Overshooting): –Ø–∫—â–æ –ø—Ä–∏ —Ä—ñ–∑–∫–æ–º—É —Ñ–ª—ñ–∫—É –ø—Ä–∏—Ü—ñ–ª –ª–µ—Ç–∏—Ç—å –¥–∞–ª—ñ –≤–æ—Ä–æ–≥–∞ ‚Äî –∑–Ω–∏–∑—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ 0.05‚Äì0.1.",
                under: "–ù–µ–¥–æ–ª—ñ—Ç (Undershooting): –Ø–∫—â–æ —Ä—É–∫–∞ ¬´–≤'—è–∑–Ω–µ¬ª —ñ –≤–∏ –Ω–µ –¥–æ–≤–æ–¥–∏—Ç–µ –¥–æ –≥–æ–ª–æ–≤–∏ ‚Äî –ø—ñ–¥–Ω—ñ–º—ñ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ 0.05‚Äì0.1.",
                restart: "–ü–æ—á–∞—Ç–∏ –Ω–æ–≤–∏–π —Ç–µ—Å—Ç"
            }
        };

        let currentLang = 'ru';

        function setLanguage(lang) {
            currentLang = lang;
            const t = i18n[lang];
            document.getElementById('txt-title').innerText = t.title;
            document.getElementById('txt-res-label').innerText = t.res;
            document.getElementById('txt-dpi-label').innerText = t.dpi;
            document.getElementById('txt-fov-label').innerText = t.fov;
            document.getElementById('txt-base-label').innerText = t.base;
            document.getElementById('calib-btn').innerText = t.calibBtn;
            document.getElementById('start-btn').innerText = t.startBtn;
            document.getElementById('txt-iter-label').innerText = t.iter;
            document.getElementById('txt-dist-label').innerText = t.dist;
            document.getElementById('txt-cm-unit').innerText = t.cm;
            document.getElementById('txt-score-label').innerText = t.score;
            document.getElementById('calib-overlay').innerHTML = t.calibOverlay;
            document.getElementById('lang-picker').value = lang;
        }

        const userLang = navigator.language.substring(0, 2);
        if (i18n[userLang]) setLanguage(userLang);
        else setLanguage('en');

        let scene, camera, renderer, target;
        let score = 0, baseSens, dpi, fov;
        let pitch = 0, yaw = 0, movementTotal = 0;
        let currentIteration = 1;
        let isCalibrating = false;
        let currentSens = 1.0;
        let flickTimer;
        const CS2_YAW = 0.022;

        function calcCm360(s) {
            const d = parseFloat(document.getElementById('dpi-input').value) || 800;
            return (360 * 2.54) / (s * d * CS2_YAW);
        }

        function initRenderer() {
            if (renderer) {
                renderer.domElement.remove();
                renderer.dispose();
            }
            const container = document.getElementById('game-container');
            const w = parseInt(document.getElementById('res-w').value);
            const h = parseInt(document.getElementById('res-h').value);
            
            container.style.width = w + 'px';
            container.style.height = h + 'px';

            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x050a14);
            camera = new THREE.PerspectiveCamera(parseInt(document.getElementById('fov-input').value), w / h, 0.1, 1000);
            
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(w, h);
            container.appendChild(renderer.domElement);
            
            scene.add(new THREE.AmbientLight(0xffffff, 0.5));
            const light = new THREE.PointLight(0x00ffcc, 1, 100);
            light.position.set(5, 5, 5);
            scene.add(light);

            const grid = new THREE.GridHelper(100, 40, 0x1e293b, 0x1e293b);
            grid.position.y = -1.5;
            scene.add(grid);

            animate();
        }

        function handleMouseMove(e) {
            if (document.pointerLockElement !== renderer.domElement) return;
            
            if (isCalibrating) {
                movementTotal += Math.abs(e.movementX);
                yaw -= e.movementX * 0.001;
            } else {
                const rad = Math.PI / 180;
                yaw -= e.movementX * CS2_YAW * currentSens * rad;
                pitch -= e.movementY * CS2_YAW * currentSens * rad;
                pitch = Math.max(-Math.PI/2.1, Math.min(Math.PI/2.1, pitch));
            }
            camera.quaternion.setFromEuler(new THREE.Euler(pitch, yaw, 0, 'YXZ'));
        }

        document.addEventListener('pointerlockchange', () => {
            if (document.pointerLockElement === null && isCalibrating) {
                stopCalibration();
            }
        });

        function stopCalibration() {
            isCalibrating = false;
            document.getElementById('calib-overlay').style.display = 'none';
            document.getElementById('start-menu').style.display = 'block';
            
            if (movementTotal > 100) {
                const estimatedSens = 360 / (movementTotal * CS2_YAW);
                document.getElementById('base-sens-input').value = estimatedSens.toFixed(4);
            }
            movementTotal = 0;
        }

        function spawnTarget() {
            if (target) scene.remove(target);
            target = new THREE.Mesh(
                new THREE.SphereGeometry(0.4, 32, 32),
                new THREE.MeshPhongMaterial({ color: 0xff007b, emissive: 0xff007b, emissiveIntensity: 0.5 })
            );
            target.position.set((Math.random()-0.5)*15, Math.random()*5+0.5, -10);
            scene.add(target);
            clearTimeout(flickTimer);
            flickTimer = setTimeout(spawnTarget, 2500); 
        }

        async function runPSA() {
            for (let i = 1; i <= 7; i++) {
                currentIteration = i;
                document.getElementById('iter-val').innerText = `${i} / 7`;
                let low = baseSens * (1 - (0.5 / i));
                let high = baseSens * (1 + (0.5 / i));
                let scoreLow = await startSingleTest(low, "LOW");
                let scoreHigh = await startSingleTest(high, "HIGH");
                baseSens = (scoreLow > scoreHigh) ? (baseSens + low) / 2 : (baseSens + high) / 2;
            }
            finishApp();
        }

        function startSingleTest(s, label) {
            return new Promise(resolve => {
                currentSens = s;
                score = 0;
                document.getElementById('sens-display').innerText = s.toFixed(3);
                document.getElementById('cm-display').innerText = calcCm360(s).toFixed(2);
                spawnTarget();
                
                let start = Date.now();
                let interval = setInterval(() => {
                    let elapsed = Date.now() - start;
                    document.getElementById('progress-bar').style.width = (100 - (elapsed/15000*100)) + "%";
                    if (elapsed >= 15000) {
                        clearInterval(interval);
                        resolve(score);
                    }
                }, 16);
            });
        }

        function animate() {
            requestAnimationFrame(animate);
            if (target && !isCalibrating && document.pointerLockElement === renderer.domElement) {
                const time = Date.now() * 0.002;
                target.position.x += Math.sin(time) * 0.07;
                target.position.y += Math.cos(time * 0.7) * 0.05 + Math.sin(time * 1.3) * 0.02;
                if (target.position.y < 0.5) target.position.y = 0.5;

                const ray = new THREE.Raycaster();
                ray.setFromCamera({x:0, y:0}, camera);
                if (target && ray.intersectObject(target).length > 0) score += 5;
                document.getElementById('score').innerText = Math.floor(score);
            }
            if (renderer) renderer.render(scene, camera);
        }

        function finishApp() {
            document.exitPointerLock();
            const finalSens = baseSens;
            const cm360 = calcCm360(finalSens).toFixed(2);
            const menu = document.getElementById('start-menu');
            const t = i18n[currentLang];
            
            menu.innerHTML = `
                <h2 style="color:var(--primary); text-shadow: 0 0 10px var(--primary);">${t.finalTitle}</h2>
                <div style="background:rgba(0,0,0,0.6); padding:20px; border-radius:10px; border: 1px solid #1e293b; text-align: left;">
                    <p style="margin: 5px 0;">${t.finalSens} <b style="font-size:1.8rem; color:var(--accent)">${finalSens.toFixed(4)}</b></p>
                    <p style="margin: 5px 0;">${t.finalPhys} <b style="color:var(--primary)">${cm360} ${t.cm}</b></p>
                    <div style="margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px; font-size: 0.85rem;">
                        <b style="color: var(--accent); display: block; margin-bottom: 5px;">${t.correction}</b>
                        <ul style="padding-left: 20px; margin: 0;">
                            <li style="margin-bottom: 8px;">${t.over}</li>
                            <li>${t.under}</li>
                        </ul>
                    </div>
                </div>
                <div class="social-links">
                    <a href="https://github.com/Adiru3" target="_blank"><img src="https://img.shields.io/badge/GitHub-Adiru3-181717?style=for-the-badge&logo=github" alt="GitHub"></a>
                    <a href="https://www.youtube.com/@adiruaim" target="_blank"><img src="https://img.shields.io/badge/YouTube-@adiruaim-FF0000?style=for-the-badge&logo=youtube" alt="YouTube"></a>
                    <a href="https://www.tiktok.com/@adiruhs" target="_blank"><img src="https://img.shields.io/badge/TikTok-@adiruhs-000000?style=for-the-badge&logo=tiktok" alt="TikTok"></a>
                    <a href="https://donatello.to/Adiru3" target="_blank"><img src="https://img.shields.io/badge/Support-Donatello-orange?style=for-the-badge" alt="Donatello"></a>
                </div>
                <button onclick="location.reload()" style="margin-top: 5px;">${t.restart}</button>
            `;
            menu.style.display = 'block';
        }

        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mousedown', () => {
            if (!isCalibrating && target && document.pointerLockElement === renderer.domElement) {
                const ray = new THREE.Raycaster();
                ray.setFromCamera({x:0, y:0}, camera);
                if (ray.intersectObject(target).length > 0) {
                    score += 1000;
                    spawnTarget();
                }
            }
        });

        document.getElementById('start-btn').onclick = () => {
            baseSens = parseFloat(document.getElementById('base-sens-input').value);
            document.getElementById('start-menu').style.display = 'none';
            initRenderer();
            renderer.domElement.requestPointerLock();
            runPSA();
        };

        document.getElementById('calib-btn').onclick = () => {
            isCalibrating = true;
            movementTotal = 0;
            document.getElementById('start-menu').style.display = 'none';
            document.getElementById('calib-overlay').style.display = 'block';
            initRenderer();
            renderer.domElement.requestPointerLock();
        };

        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && isCalibrating) document.exitPointerLock(); 
        });
    </script>
</body>
</html>